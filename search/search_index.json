{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Pr\u00e1ctica 2.3 \u2013 Proxy inverso con Nginx","text":"<p>Para ello debemos de clonar nuestra m\u00e1quina con el servidor nginx de la pr\u00e1ctica anterior. Una de las dos har\u00e1 de webserver y otra del proxy que redirigir\u00e1 el trafico. Para toda la configuraci\u00f3n es ideal tener las dos m\u00e1quinas virtuales encendidas.</p>"},{"location":"#configurar-el-webserver","title":"Configurar el webserver","text":"<p>Para configurar el webserver debemos de hacer dos cosas. La primera es cambiarle el nombre al servidor a webserver tanto en los archivos de configuraci\u00f3n de site-enabled de nginx como en site-available, as\u00ed como en /var/www. Despu\u00e9s debemos de cambiar el archivo de configuraci\u00f3n para ajustarlo a su nuevo rol. </p> <p>Para ello primero debemos de deshacer el enlace simb\u00f3lico entre las dos carpetas y modificar el nombre del servidor.</p> <p></p> <p>despu\u00e9s cambiamos el nombre</p> <p></p> <p></p> <p>Ahora vamos a cambiar el nombre del servidor en su archivo de configuraci\u00f3n a webserver. Ahora escuchar\u00e1 las peticiones del puerto 8080, de forma que el archivo de configuraci\u00f3n queda como:</p> <p></p> <p>Ahora solo queda crear de nuevo el archivo de configuraci\u00f3n en site-available mediante un enlace simb\u00f3lico y reiniciar nginx</p> <p></p>"},{"location":"#configurar-el-proxy-inverso","title":"Configurar el proxy-inverso","text":"<p>Ahora debemos de cambiar el nombre del archivo de configuraci\u00f3n a valfrio-proxy (cualquier nombre que elijas-proxy) y cambiar el archivo de configuraci\u00f3n. Ahora escuchar\u00e1 las peticiones del puerto 80 y las reenviar\u00e1 al webserver</p> <p></p> <p>La linea proxy_pass se encarga de la redirecci\u00f3n, haciendo una petici\u00f3n http a la ip de nuestro servidor en el puerto 8080. Ahora podemos ver los logs de acceso de los dos servidores para ver que la petici\u00f3n se halla pasado por el proxy. Primero el log de acceso del proxy:</p> <p></p> <p>y la del webserver:</p> <p></p>"},{"location":"#comprobacion-con-cabeceras","title":"Comprobaci\u00f3n con cabeceras","text":"<p>Ahora para que la comprobaci\u00f3n sea un poco m\u00e1s clara vamos a usar cabeceras. Para ello debemos de modificar los archivos de configuraci\u00f3n del proxy y el server. Para ello debemos a\u00f1adir la linea add_header Host nombre_del_host; en location para que en la petici\u00f3n vaya la cabecera con el nombre del host. La modificaci\u00f3n ser\u00eda algo as\u00ed:</p> <p></p> <p>Despu\u00e9s en el servidor igual. Ahora cuando hagamos la petici\u00f3n podremos ver en las herramientas de desarrollador que trae la cabecera introducida en el archivo de configuraci\u00f3n.</p> <p></p> <p>Por \u00faltimo modificamos de la misma forma el webserver. Deber\u00edamos recibir las dos cabeceras</p> <p></p>"}]}